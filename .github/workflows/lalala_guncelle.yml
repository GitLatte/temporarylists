name: ğŸ“ºğŸ”„ LaLaLa

on:
  push:
    paths:
      - "dl/dl-daddyliveall.m3u"
      - "dl/daddyliveevents.m3u"
  workflow_dispatch:  # Manuel Ã§alÄ±ÅŸtÄ±rma seÃ§eneÄŸi

jobs:
  update_m3u:
    runs-on: ubuntu-latest

    steps:
    - name: Depoyu Ã§ek
      uses: actions/checkout@v4

    - name: Python'u kur
      uses: actions/setup-python@v4
      with:
        python-version: '3.x'

    - name: BaÄŸÄ±mlÄ±lÄ±klarÄ± yÃ¼kle
      run: pip install requests

    # - name: Stream URLâ€™lerini temizle ve Base64 kodlarÄ±nÄ± decode et #
    #  run: python .github/scripts/lalala.py #

    - name: GÃ¼ncellenmiÅŸ dosyayÄ± repoya yÃ¼kle
      env:
        GITHUB_TOKEN: ${{ secrets.LATTE_PAT }}
      run: |
        git config --global user.name "GitHub Actions"
        git config --global user.email "actions@github.com"
        git add -A  # TÃ¼m dosyalarÄ± ekle
        git commit --allow-empty -m "â™» Otomatik gÃ¼ncellenmiÅŸ M3U listesi"
        git push origin main
    
    - name: Temizle Gitsin
      run: |
          git config --local user.email "github-actions[bot]@users.noreply.github.com"
          git config --local user.name "github-actions[bot]"
          
          git checkout --orphan new_main
          git add -A
          git commit -m "â™» Listeler gÃ¼ncellendi ğŸ§¹ GeÃ§miÅŸe paydos!"
          
          git branch -D main
          git branch -m main
          
          git push --force --set-upstream origin main        
