name: ğŸ“ºğŸ”„ V TÃ¼m Kanallar
on:
  schedule:
    - cron: '0 */6 * * *'  # Her 6 saatte bir Ã§alÄ±ÅŸÄ±r
  workflow_dispatch: # Manuel Ã§alÄ±ÅŸtÄ±rma

jobs:
  generate_m3u:
    runs-on: ubuntu-latest

    steps:
    - name: Depoyu Ã§ek
      uses: actions/checkout@v3

    - name: Python'u kur
      uses: actions/setup-python@v4
      with:
        python-version: '3.x'

    - name: BaÄŸÄ±mlÄ±lÄ±klarÄ± yÃ¼kle
      run: pip install requests

    - name: M3U dosyasÄ±nÄ± oluÅŸtur
      run: python .github/scripts/v_tum_icerikler.py

    - name: GÃ¼ncellenmiÅŸ dosyayÄ± repoya yÃ¼kle
      env:
        GITHUB_TOKEN: ${{ secrets.LATTE_PAT }}
      run: |
        git config --global user.name "GitHub Actions"
        git config --global user.email "actions@github.com"
        git add tospecial/v-tum-kanallar.m3u
        git commit -m "Otomatik gÃ¼ncellenmiÅŸ M3U listesi"
        git push origin main

    - name: Temizle Gitsin
      run: |
          git config --local user.email "github-actions[bot]@users.noreply.github.com"
          git config --local user.name "github-actions[bot]"
          
          git checkout --orphan new_main
          git add -A
          git commit -m "â™» Listeler gÃ¼ncellendi ğŸ§¹ GeÃ§miÅŸe paydos!"
          
          git branch -D main
          git branch -m main
          
          git push --force --set-upstream origin main                
